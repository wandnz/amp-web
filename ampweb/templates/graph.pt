<body metal:define-macro="body">
    <script>
        /* Sets up variables initially */
        $(document).ready(function() {
            var urlparts = [];
            
            /* Split URL into parts */
            urlparts = window.location.toString().split("graph/")[1].split("/");
            
            /* Add blanks to the end of the array to cover missing url parts */
            for (var i = 0; i < 5; i++) {
                urlparts.push("");
            }
            
            /* Set variables */
            if (urlparts[0] != undefined && urlparts[0].substring(0, 1) == "#") {
                source = urlparts[0].substring(1);
            }
            else {
                source = urlparts[0];
            }
            dest = urlparts[1];
            graph = urlparts[2];
            starttime = urlparts[3];
            endtime = urlparts[4];           
            ${startgraph}
        });

        /* Get's history.js running */
        (function(window,undefined) {
            /* Prepare */
            var History = window.History; 
            if (!History.enabled) {
                 /*
                  * History.js is disabled for this browser.
                  * This is because we can optionally choose to support HTML4 browsers or not.
                  */
                return false;
            }

            /* Bind to StateChange Event */
            History.Adapter.bind(window,'statechange',function() { 
                var State = History.getState(); 
                History.log(State.data, State.title, State.url);
            });
        })(window);
    </script>
    <div id="choices">
        Display From:
        <select id="source" name="source" onChange="pageUpdate(this); changeGraph();" >
            <option>--SELECT--</option>
            <option tal:repeat="item sources" value="${item['name']}" tal:attributes="selected '' if item['selected'] == True else None">${item['name']}</option>
        </select>
        to:
        <select id="dest" name="dest" onChange="pageUpdate(this); changeGraph({graph: 'Latency'});" tal:attributes="disabled '' if enabledest == False else None">          
            <option>--SELECT--</option>
            <option tal:repeat="item destinations" value="${item['name']}" tal:attributes="selected '' if item['selected'] == True else None">${item['name']}</option>
        </select>
    </div>
    <div id="graph_options">
        <ul id="icons">
            <li class="icon"><a onclick="changeGraph({graph: 'Latency'}) "><span id="sparklineLatency"></span><br>Latency</a></li>
                <br>
            <li class="icon"><a onclick="changeGraph({graph: 'Jitter'})"><span id="sparklineJitter"></span><br>Jitter</a></li>
                <br>
            <li class="icon"><a onclick="changeGraph({graph: 'Loss'})"><span id="sparklineLoss"></span></a><br>Loss</li>
                <br>
            <li class="icon"><a onclick="changeGraph({graph: 'Path'})"><span id="sparklinePath"></span></a><br>Path Analysis</li>
        </ul>
    </div>
    <div id="graph">Graph Goes Here</div>
    <div id="graph_controls">
        <ul id="time_selections">
            <li class="time_select">Day</li>
            <li class="time_select">Month</li>
            <li class="time_select">Year</li>
        </ul>
    </div>
</body>
